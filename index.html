<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Wedding Seating Chart</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
  font-family: "Georgia", serif;
  background: #f9f7f4;
  margin: 0;
  padding: 20px;
  color: #333;
}

.container {
  max-width: 700px;
  margin: auto;
}

h1 {
  text-align: center;
  font-weight: normal;
}

p {
  text-align: center;
  color: #666;
}

input {
  width: 100%;
  padding: 16px;
  font-size: 18px;
  margin: 20px 0;
  border: 1px solid #ccc;
  border-radius: 8px;
}

.result {
  text-align: center;
  font-size: 22px;
  font-weight: bold;
  margin-bottom: 20px;
}

.list-title {
  margin-top: 40px;
  font-size: 20px;
  text-align: center;
}

.guest {
  padding: 10px;
  border-bottom: 1px solid #ddd;
  display: flex;
  justify-content: space-between;
}
</style>
</head>

<body>
<div class="container">

<h1>Welcome</h1>
<p>Scan & find your table</p>

<input id="search" placeholder="Enter your name">

<div class="result" id="result"></div>

<div class="list-title">Alphabetical Seating Chart</div>
<div id="list"></div>

</div>

<script>
let guests = [];
let baseList = [];

fetch("https://docs.google.com/spreadsheets/d/1x8Ps1XIlHwN9AgIw6PvpV6hH0uPCbrgVpK-bPVyHY7E/export?format=csv")
  .then(res => res.text())
  .then(data => {
    let rows = data.trim().split("\n").slice(1);

    rows.forEach(row => {
      let [name, table] = row.split(",");
      if (name && table) {
        guests.push({
          name: name.replace(/"/g, "").trim(),
          table: table.replace(/"/g, "").trim()
        });
      }
    });

    // base alphabetical order
    guests.sort((a, b) => a.name.localeCompare(b.name));
    baseList = [...guests];

    renderList(baseList);
  });

document.getElementById("search").addEventListener("input", function () {
  let value = this.value.toLowerCase().trim();

  if (!value) {
    renderList(baseList);
    document.getElementById("result").innerText = "";
    return;
  }

  let matches = [];
  let others = [];

  baseList.forEach(g => {
    if (g.name.toLowerCase().includes(value)) {
      matches.push(g);
    } else {
      others.push(g);
    }
  });

  renderList([...matches, ...others]);

  let exact = baseList.find(
    g => g.name.toLowerCase() === value
  );

  document.getElementById("result").innerText =
    exact ? `Your table number is ${exact.table}` : "";
});

function renderList(list) {
  let html = "";

  list.forEach(g => {
    html += `
      <div class="guest">
        <span>${g.name}</span>
        <span>Table ${g.table}</span>
      </div>
    `;
  });

  document.getElementById("list").innerHTML = html;
}
</script>

</body>
</html>
